<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Encrypting Connections :: TigerGraph Server User Guide</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">TigerGraph Server User Guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="tigergraph-server" data-version="3.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../installation/install.html">TigerGraph Server User Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/internal-architecture.html">TigerGraph Internal Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../getting-started/docker.html">Getting started with Docker</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/install.html">Installation Guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">The GSQL Shell</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../gsql-shell/using-a-remote-gsql-client.html">Using a Remote GSQL Client</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Definition</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-definition/README.html">Data Definition</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data loading</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-loading/s3-loader-user-guide.html">AWS S3 Loader User Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-loading/spark-connection-via-jdbc-driver.html">Spark Connection Via JDBC Driver</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">System management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/README.html">System Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/management-with-gadmin.html">Managing with gadmin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/README.html">User Access Management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Backup and Restore</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../backup-and-restore/backup-and-restore.html">Backup and Restore</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST API Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../API/intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../API/built-in-endpoints.html">Built-in Endpoints</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">References</span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">TigerGraph Server User Guide</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../installation/install.html">TigerGraph Server User Guide</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../installation/install.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../tigergraph-gui/3.2/graphstudio/overview.html">TigerGraph Web UI Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../tigergraph-gui/3.2/graphstudio/overview.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../installation/install.html">TigerGraph Server User Guide</a></li>
    <li><a href="encrypting-connections.html">Encrypting Connections</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/lennessyy/tg-server/edit/main/modules/security/pages/data-encryption/encrypting-connections.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Encrypting Connections</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>TigerGraph supports secure data-in-flight communication, using SSL/TLS encryption protocol. This applies to any outward-facing channel, including GSQL clients, RESTPP endpoints, and the GraphStudio web interface. When SSL/TLS is enabled, HTTPS takes the place of HTTP for RESTPP and GraphStudio connections.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You should have basic knowledge about how SSL works:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What the SSL certificate and key are used for</p>
</li>
<li>
<p>That an SSL certificate is bound to a domain</p>
</li>
<li>
<p>How an SSL certificate chain works</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A good primer on SSL is available to <a href="https://httpd.apache.org/docs/2.4/ssl/ssl_intro.html" class="bare">https://httpd.apache.org/docs/2.4/ssl/ssl_intro.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nginx_based"><a class="anchor" href="#_nginx_based"></a>Nginx-Based</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TigerGraph uses the Nginx web server, so SSL configuration makes use of some built-in support in Nginx.</p>
</div>
<div class="paragraph">
<p><a href="http://nginx.org/en/docs/http/configuring_https_servers.html" class="bare">http://nginx.org/en/docs/http/configuring_https_servers.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_1_obtain_an_ssl_certificate"><a class="anchor" href="#_step_1_obtain_an_ssl_certificate"></a>Step 1. Obtain an SSL Certificate</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The two main options for obtaining an SSL Certificate are to generate your own self-signed certificate or to purchase a certificate from a trusted Certificate Authority. Regardless of which method you choose, your certificate should be chained to a trusted root certificate embedded in your browser. The options and details for producing a trusted SSL certificate are beyond the scope of this document. The focus of this document is how to configure your TigerGraph system to use the certificate to enable SSL.</p>
</div>
<div class="sect2">
<h3 id="_option_1_using_a_certificate_from_a_trusted_agent"><a class="anchor" href="#_option_1_using_a_certificate_from_a_trusted_agent"></a>Option 1: Using a Certificate From A Trusted Agent</h3>
<div class="paragraph">
<p>First, obtain an SSL certificate from a trusted agent of your choice. Certificate vendors will provide clear instructions for ordering a certificate and then for installing it on your system.</p>
</div>
<div class="paragraph">
<p>Then you can configure the certificate with <code>gadmin --configure ssl</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_option_2_create_a_self_signed_certificate"><a class="anchor" href="#_option_2_create_a_self_signed_certificate"></a>Option 2: Create a Self-Signed Certificate</h3>
<div class="paragraph">
<p>There are multiple ways to create a self-signed certificate.  One example is shown below.</p>
</div>
<div class="paragraph">
<p>{% hint style="danger" %}
For simplicity, the method below will use the root certificate directly as the HTTPS server certificate.  This method is satisfactory for testing but should not be used for a production system.
{% endhint %}</p>
</div>
<div class="paragraph">
<p>{% hint style="info" %}
In the example below, the Common Name value should be your server hostname, since HTTPS certificates are bound to domain names.
{% endhint %}</p>
</div>
<div class="paragraph">
<p>{% code title="Self-Signed Certificate generation example using openssl" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout ~/nginx-selfsigned.key -out ~/nginx-selfsigned.crt

Generating a 2048 bit RSA private key
.................................................................................................................................+++
........+++
writing new private key to '/home/tigergraph/nginx-selfsigned.key'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:California
Locality Name (eg, city) []:Redwood City
Organization Name (eg, company) [Internet Widgits Pty Ltd]:TigerGraph
Organizational Unit Name (eg, section) []:GLE
Common Name (e.g. server FQDN or YOUR name) []: my.ip.addr.num
Email Address []:engineer@tigergraph.com</pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
<div class="sect2">
<h3 id="_change_the_certificate_permission"><a class="anchor" href="#_change_the_certificate_permission"></a>Change the Certificate Permission</h3>
<div class="paragraph">
<p>For security reasons, the certificates can only be used with permission 600 or less.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ chmod 600 ~/nginx-selfsigned.*</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_2_configure_ssl_with_gadmin"><a class="anchor" href="#_step_2_configure_ssl_with_gadmin"></a>Step 2: Configure SSL with <code>gadmin</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the self-signed certificate successfully generated, you can configure it with <code>gadmin</code>, so that all the HTTP traffic will be protected with SSL.</p>
</div>
<div class="paragraph">
<p>{% hint style="info" %}
TigerGraph&#8217;s SSL only accepts PEM-encoded certificates. If you have a certificate encoded in other formats (e.g. DER), you need to <a href="https://www.sslshopper.com/ssl-converter.html">convert it to a PEM-encoded certificate</a> first.
{% endhint %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gadmin config entry ssl

​Nginx.SSL.Enable [ false ]: Enable SSL connection for all HTTP requests
New: true

Nginx.SSL.Key [ &lt;masked&gt; ]: Private key for SSL
New: @privateKey_file_path

Nginx.SSL.Cert [ &lt;masked&gt; ]: Public certificate for SSL
New: @ssl_cert_path

# This config (Nginx.ProxySSLVerify) was removed in v3.1.1
Nginx.ProxySSLVerify [ false ]: Enable verification of the proxied HTTPS server certificate. Recommend to turn on.
New: true</pre>
</div>
</div>
<div class="paragraph">
<p>After saving the settings, apply the configuration settings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gadmin config apply -y

[ Info] Successfully applied configuration change. Please restart services to make it effective immediately.</pre>
</div>
</div>
<div class="paragraph">
<p>Then restart the following services: <code>gsql</code>, <code>nginx</code>, <code>ts3</code>, and <code>gui</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gadmin restart gsql nginx gui ts3 -y</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_your_ssl_connection"><a class="anchor" href="#_testing_your_ssl_connection"></a>Testing Your SSL Connection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you may test the connection.</p>
</div>
<div class="paragraph">
<p>A direct curl request to the server will fail due to certificate verification failure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl https://localhost:14240

curl: (60) server certificate verification failed. CAfile: /etc/ssl/certs/ca-certificates.crt CRLfile: none
More details here: http://curl.haxx.se/docs/sslcerts.html

curl performs SSL certificate verification by default, using a "bundle"
of Certificate Authority (CA) public keys (CA certs). If the default
bundle file isn't adequate, you can specify an alternate file
using the --cacert option.

If this HTTPS server uses a certificate signed by a CA represented in
the bundle, the certificate verification probably failed due to a
problem with the certificate (it might be expired, or the name might
not match the domain name in the URL).

If you'd like to turn off curl's verification of the certificate, use
the -k (or --insecure) option.</pre>
</div>
</div>
<div class="paragraph">
<p>{% hint style="danger" %}
 In v1.2, the default TCP/IP port for Nginx has changed from 44240 to 14240, to avoid possible port conflicts with Zookeeper.
{% endhint %}</p>
</div>
<div class="paragraph">
<p>You may use the -k option to turn off the verification, but it is unsafe and not recommended.</p>
</div>
<div class="paragraph">
<p>To successfully make requests with curl, you will need to specify the certificate by using the <code>--cacert</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl --cacert /home/tigergraph/nginx-selfsigned.crt https://localhost:14240

&lt;!doctype html&gt;&lt;html lang="en"&gt;&lt;head&gt;&lt;meta charset="utf-8"&gt;&lt;title&gt;GraphStudio&lt;/title&gt;&lt;base href="/"&gt;&lt;meta name="viewport" content="width=device-width,initial-scale=1"&gt;&lt;link rel="icon" type="image/x-icon" href="favicon.ico"&gt;&lt;link href="styles.d67299ba9f5d73aecbe2.bundle.css" rel="stylesheet"/&gt;&lt;/head&gt;&lt;body class="mat-typography"&gt;&lt;app-root&gt;&lt;/app-root&gt;&lt;script type="text/javascript" src="inline.4aae6a8088c30a61d5b0.bundle.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="polyfills.c9b879328f3396b2bbe8.bundle.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="vendor.5392e4ea4f904cd1658c.bundle.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="main.a39087227fcdf478cd2a.bundle.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</pre>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
