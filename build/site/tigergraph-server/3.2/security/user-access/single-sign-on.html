<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Single Sign-On :: TigerGraph Server User Guide</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">TigerGraph Server User Guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="tigergraph-server" data-version="3.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../installation/install.html">TigerGraph Server User Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/internal-architecture.html">TigerGraph Internal Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../getting-started/docker.html">Getting started with Docker</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/install.html">Installation Guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">The GSQL Shell</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../gsql-shell/using-a-remote-gsql-client.html">Using a Remote GSQL Client</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Definition</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-definition/README.html">Data Definition</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data loading</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-loading/s3-loader-user-guide.html">AWS S3 Loader User Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-loading/spark-connection-via-jdbc-driver.html">Spark Connection Via JDBC Driver</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">System management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/README.html">System Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/management-with-gadmin.html">Managing with gadmin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="README.html">User Access Management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Backup and Restore</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../backup-and-restore/backup-and-restore.html">Backup and Restore</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST API Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../API/intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../API/built-in-endpoints.html">Built-in Endpoints</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">References</span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">TigerGraph Server User Guide</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../installation/install.html">TigerGraph Server User Guide</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../installation/install.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../tigergraph-gui/3.2/graphstudio/overview.html">TigerGraph Web UI Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../tigergraph-gui/3.2/graphstudio/overview.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../installation/install.html">TigerGraph Server User Guide</a></li>
    <li><a href="single-sign-on.html">Single Sign-On</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/lennessyy/tg-server/edit/main/modules/security/pages/user-access/single-sign-on.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Single Sign-On</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Single Sign-On (SSO) feature in TigerGraph enables you to use your organization&#8217;s identity provider (IDP) to authenticate users to access TigerGraph GraphStudio and Admin Portal UI.</p>
</div>
<div class="paragraph">
<p>Currently we have verified following the identity providers which support SAML 2.0 protocol:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.okta.com/">Okta</a></p>
</li>
<li>
<p><a href="https://auth0.com/">Auth0</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For supporting additional IDPs, please inquire <a href="mailto:sales@tigergraph.com">sales@tigergraph.com</a> and submit a feature request.</p>
</div>
<div class="paragraph">
<p>In order to use Single Sign-On , you need to perform four steps :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure your identity provider to create a TigerGraph application.</p>
</li>
<li>
<p>Provide information from your identity provider to enable TigerGraph Single Sign-On .</p>
</li>
<li>
<p>Create user groups with proxy rules to authorize Single Sign-On users.</p>
</li>
<li>
<p>Change the password of the tigergraph user to be other than the default, if you haven&#8217;t done so already.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We assume you already have TigerGraph up and running , and you can access GraphStudio UI through a web browser using the URL:</p>
</div>
<div class="paragraph">
<p>{% hint style="info" %}
 <a href="http://tigergraph-machine-hostname:14240" class="bare">http://tigergraph-machine-hostname:14240</a>
{% endhint %}</p>
</div>
<div class="paragraph">
<p>If you enabled SSL connection, change http to https. If you changed the nginx port of the TigerGraph system, replace 14240 with the port you have set.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configure_identity_provider"><a class="anchor" href="#_configure_identity_provider"></a><strong>Configure Identity Provider</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here we provide detailed instructions for identity providers that we have verified. Please consult your IT or security department for how to configure the identity provider for your organization if it is not listed here.</p>
</div>
<div class="paragraph">
<p>After you finish configuring your identity provider, you will get an Identity Provider Single Sign-On URL , Identity Provider Entity Id , and an X.509 certificate file idp.cert . You need these 3 things to configure TigerGraph next.</p>
</div>
<div class="sect2">
<h3 id="_okta"><a class="anchor" href="#_okta"></a>Okta</h3>
<div class="paragraph">
<p>After logging into Okta as the admin user, click Admin button at the top-right corner.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.1.png" alt="11.1">
</div>
</div>
<div class="paragraph">
<p>Click Add Applications in the right menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.2.png" alt="11.2">
</div>
</div>
<div class="paragraph">
<p>Click Create New App button in the left toolbar.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.3.png" alt="11.3">
</div>
</div>
<div class="paragraph">
<p>In the pop up window, choose SAML 2.0 and click Create .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.4.png" alt="11.4">
</div>
</div>
<div class="paragraph">
<p>Input TigerGraph (or whatever application name you want to use) in App Name , and click Next . Upload a logo if you like.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.5.png" alt="11.5">
</div>
</div>
<div class="paragraph">
<p>Enter the Assertion Consumer Service URL / Single sign on URL , and SP Entity ID .</p>
</div>
<div class="paragraph">
<p>Both are URLs in our case. You need to know the hostname of the TigerGraph machine. If you can visit GraphStudio UI through a browser, the URL contains the hostname. It can be either an IP or a domain name.</p>
</div>
<div class="paragraph">
<p>The Assertion Consumer Service URL , or Single sign on URL, is</p>
</div>
<div class="paragraph">
<p>{% hint style="info" %}
 <a href="http://tigergraph-machine-hostname:14240/api/auth/saml/acs" class="bare">http://tigergraph-machine-hostname:14240/api/auth/saml/acs</a>
{% endhint %}</p>
</div>
<div class="paragraph">
<p>The SP entity id URL is:</p>
</div>
<div class="paragraph">
<p>{% hint style="info" %}
<a href="http://tigergraph-machine-hostname:14240/gsqlserver/gsql/saml/meta" class="bare">http://tigergraph-machine-hostname:14240/gsqlserver/gsql/saml/meta</a>
{% endhint %}</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.6%20%281%29%20%281%29%20%281%29.png" alt="11.6%20%281%29%20%281%29%20%281%29">
</div>
</div>
<div class="paragraph">
<p>Scroll to the bottom for Group Attribute Statements. Usually you want to grant roles to users based on their user group. You can give a name to your attribute statement; here we use group . For filter, we want to return all group attribute values of all users, so we use Regex .* as the filter. Click Next after you set up everything.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.7.png" alt="11.7">
</div>
</div>
<div class="paragraph">
<p>In the final step, choose whether you want to integrate your app with Okta or not. Then click Finish .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.8.png" alt="11.8">
</div>
</div>
<div class="paragraph">
<p>Now your Okta identity provider settings are finished. Click View Setup Instructions button to gather information you will need to setup TigerGraph Single Sign-On.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.9.png" alt="11.9">
</div>
</div>
<div class="paragraph">
<p>Here you want to save Identity Provider Single Sign-On URL and Identity Provider Issuer (usually known as Identity Provider Entity Id ). Download the certificate file as okta.cert, rename it as idp.cert , and put it somewhere on the TigerGraph machine. Let&#8217;s assume you put it under your home folder: /home/tigergraph/idp.cert. If you installed TigerGraph in a cluster, you should put it on the machine where the GSQL server is installed (usually it&#8217;s the machine whose alias is m1).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.10.png" alt="11.10">
</div>
</div>
<div class="paragraph">
<p>Finally, return to previous page, go to the Assignments tab, click the Assign button, and assign people or groups in your organization to access this application.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.12.png" alt="11.12">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auth0"><a class="anchor" href="#_auth0"></a>Auth0</h3>
<div class="paragraph">
<p>After logging into Auth0, click Clients in the left navigation bar, and then click CREATE CLIENT button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.13.png" alt="11.13">
</div>
</div>
<div class="paragraph">
<p>In the pop-up window, enter TigerGraph (or whatever application name you want to use) in the Name input box. Choose Single Page Web Application , and then click the CREATE button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.14.png" alt="11.14">
</div>
</div>
<div class="paragraph">
<p>Click Clients again. In the Shown Clients list, click the settings icon of your newly created TigerGraph client.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.15.png" alt="11.15">
</div>
</div>
<div class="paragraph">
<p>Scroll down to the bottom of the settings section, and click Show Advanced Settings .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.16.png" alt="11.16">
</div>
</div>
<div class="paragraph">
<p>Click the Certificates tab and then click DOWNLOAD CERTIFICATE. In the chooser list, choose CER. Rename the downloaded file as idp.cert , and put it somewhere on the TigerGraph machine. Let&#8217;s assume you put it under your home folder: /home/tigergraph/idp.cert. If you installed TigerGraph in a cluster, you should put it on the machine where the GSQL server is installed ( usually it&#8217;s the machine whose alias is m1 ).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.17.png" alt="11.17">
</div>
</div>
<div class="paragraph">
<p>Click the Endpoints tab, and copy the text in the SAML Protocol URL text box.  This is the Identity Provider Single Sign-On URL that will be used to configure TigerGraph in an upcoming step.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.18.png" alt="11.18">
</div>
</div>
<div class="paragraph">
<p>Scroll up to the top of the page, click the Addons tab, and switch on the toggle at the right side of the SAML2 card.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.19.png" alt="11.19">
</div>
</div>
<div class="paragraph">
<p>In the pop-up window, enter the Assertion Consumer Service URL in the Application Callback URL input box:</p>
</div>
<div class="paragraph">
<p>{% hint style="info" %}
<a href="http://tigergraph-machine-hostname:14240/api/auth/saml/acs" class="bare">http://tigergraph-machine-hostname:14240/api/auth/saml/acs</a>
{% endhint %}</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.20.png" alt="11.20">
</div>
</div>
<div class="paragraph">
<p>Scroll down to the end of the settings JSON code, click the DEBUG button, and log in as any existing user in your organization in the pop-up login page.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.21.png" alt="11.21">
</div>
</div>
<div class="paragraph">
<p>If login in successfully, the SAML response will be shown in decoded XML format. Scroll down to the attributes section. Here you will see some attribute names, which you will use to set proxy rules when creating groups in an upcoming configuration step.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.22.png" alt="11.22">
</div>
</div>
<div class="paragraph">
<p>Return to the previous pop-up window and click the Usage tab. Copy the Issuer value. This is the Identity Provider Entity Id that will be used to configure TigerGraph in an upcoming step.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.23.png" alt="11.23">
</div>
</div>
<div class="paragraph">
<p>Click <em>**</em>the Settings tab, scroll to the bottom of the pop-up window, and click the SAVE button. Close the pop-up window.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.24.png" alt="11.24">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enable_single_sign_on_in_tigergraph"><a class="anchor" href="#_enable_single_sign_on_in_tigergraph"></a><strong>Enable Single Sign-On in TigerGraph</strong></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prepare_certificate_and_private_key_on_tigergraph_machine"><a class="anchor" href="#_prepare_certificate_and_private_key_on_tigergraph_machine"></a>Prepare certificate and private key on TigerGraph machine</h3>
<div class="paragraph">
<p>According to the SAML standard trust model, a self-signed certificate is considered fine. This is different from configuring a SSL connection, where a CA-authorized certificate is considered mandatory if the system goes to production.</p>
</div>
<div class="paragraph">
<p>There are multiple ways to create a self-signed certificate.  One example is shown below.</p>
</div>
<div class="paragraph">
<p>First, use the following command to generate a private key in PKCS#1 format and a X.509 certificate file. In the example below, the Common Name value should be your server hostname (IP or domain name).</p>
</div>
<div class="paragraph">
<p>{% code title="Self-Signed Certificate generation example using openssl" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /home/tigergraph/sp-pkcs1.key -out /home/tigergraph/sp.cert

Generating a 2048 bit RSA private key
.................................................................................................................................+++
........+++
writing new private key to '/home/tigergraph/sp-pkcs1.key'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:California
Locality Name (eg, city) []:Redwood City
Organization Name (eg, company) [Internet Widgits Pty Ltd]:TigerGraph Inc.
Organizational Unit Name (eg, section) []:GLE
Common Name (e.g. server FQDN or YOUR name) []: tigergraph-machine-hostname
Email Address []:support@tigergraph.com</pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>Second, convert your private key from PKCS#1 format to PKCS#8 format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>openssl pkcs8 -topk8 -inform pem -nocrypt -in /home/tigergraph/sp-pkcs1.key -outform pem -out /home/tigergraph/sp.pem</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enable_and_configure_single_sign_on_using_gadmin"><a class="anchor" href="#_enable_and_configure_single_sign_on_using_gadmin"></a>Enable and configure Single Sign-On Using Gadmin</h3>
<div class="paragraph">
<p>From a TigerGraph machine, run the following command: gadmin config entry Security.SSO.SAML</p>
</div>
<div class="paragraph">
<p>Answering the questions is straightforward; an example is shown below.</p>
</div>
<div class="paragraph">
<p>{% hint style="info" %}
Since v2.3, the requirements for the Security.SSO.SAML.SP.Hostname parameter changed. The url must be a full url, starting with protocol (such as http) and ending with port number.
{% endhint %}</p>
</div>
<div class="paragraph">
<p>{% code title="configure sso.saml example" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gadmin config entry Security.SSO.SAML

Security.SSO.SAML.Enable [ false ]: Enable SAML2-based SSO: default false
New: true

Security.SSO.SAML.AuthnRequestSigned [ true ]: Sign AuthnRequests before sending to Identity Provider: default true
New: true

Security.SSO.SAML.AssertionSigned [ true ]: Require Identity Provider to sign assertions: default true
New: true

Security.SSO.SAML.ResponseSigned [ true ]: Require Identity Provider to sign SAML responses: default true
New: false

Security.SSO.SAML.MetadataSigned [ true ]: Sign Metadata: default true
New: true

Security.SSO.SAML.SignatureAlgorithm [ rsa-sha256 ]: Signiture algorithm [rsa-sha1/rsa-sha256/rsa-sha384/rsa-sha512]: default rsa-sha256
New: rsa-sha256

Security.SSO.SAML.BuiltinUser [ __GSQL__saml ]: The builtin user for SAML
New: __GSQL__saml

Security.SSO.SAML.RequestedAuthnContext [  ]: Authentication context (comma separate multiple values)
New: urn:oasis:names:tc:SAML:2.0:ac:classes:Password

Security.SSO.SAML.SP.Hostname [ http://127.0.0.1:14240 ]: TigerGraph Service Provider URL: default http://127.0.0.1:14240
New: http://localhost:14240

Security.SSO.SAML.SP.X509Cert [  ]: Content of the x509 Certificate: default empty. You can use @/cert/file/path to pass the certificate from a file.
New: &lt;x509 certificate&gt;

Security.SSO.SAML.SP.PrivateKey [  ]: Content of the host machine's private key. Require PKCS#8 format (start with "BEGIN PRIVATE KEY"). You can use @/privatekey/file/path to pass the certificate from a file.
New: &lt;private key&gt;

Security.SSO.SAML.IDP.EntityId [ http://idp.example.com ]: Identity Provider Entity ID: default http://idp.example.com
New: http://idp.example.com

Security.SSO.SAML.IDP.SSOUrl [ http://idp.example.com/sso/saml ]: Single Sign-On URL: default http://idp.example.com/sso/saml
New: http://idp.example.com/sso/saml

Security.SSO.SAML.IDP.X509Cert [  ]: Identity Provider's x509 Certificate filepath: default empty
New: /home/tigergraph/idp.cert</pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>The reason we change Security.SSO.SAML.ResponseSigned to false is because some identity providers (e.g., Auth0) don&#8217;t support signed assertion and response at the same time. If your identity provider supports signing both, we strongly suggest you leave it as true.</p>
</div>
<div class="paragraph">
<p>After making the configuration settings, apply the config changes, and restart gsql.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gadmin config apply -y
$ gadmin restart gsql -y</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_user_groups_with_proxy_rules_to_authorize_single_sign_on_users"><a class="anchor" href="#_create_user_groups_with_proxy_rules_to_authorize_single_sign_on_users"></a><strong>Create user groups with proxy rules to authorize Single Sign-On users</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to authorize Single Sign-On users, you need create user groups in GSQL with proxy rules and grant roles on graphs for the user groups.</p>
</div>
<div class="paragraph">
<p>In TigerGraph Single Sign-On, we support two types of proxy rules. The first type is nameid equations; the second type is attribute equations. Attribute equations are more commonly used because usually user group information is transferred as attributes to your identity provider SAML assertions. In the Okta identity provider configuration example, it is transferred by the attribute statement named group . By granting roles to a user group, all users matching the proxy rule will be granted all the privileges of that role.  In some cases if you want to grant one specific Single Sign-On user some privilege, you can use a nameid equation to do so.</p>
</div>
<div class="sect2">
<h3 id="_single_user_proxy"><a class="anchor" href="#_single_user_proxy"></a>Single User Proxy</h3>
<div class="paragraph">
<p>For example, if you want to create a user group SuperUserGroup that contains the user with nameid <a href="mailto:admin@your.company.com">admin@your.company.com</a> only, and grant superuser role to that user, you can do so with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GSQL &gt; CREATE GROUP SuperUserGroup PROXY "nameid=admin@your.company.com"
GSQL &gt; GRANT ROLE superuser TO SuperUserGroup
Role "superuser" is successfully granted to user(s): SuperUserGroup</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user_group_proxy"><a class="anchor" href="#_user_group_proxy"></a>User Group Proxy</h3>
<div class="paragraph">
<p>Suppose you want to create a user group HrDepartment which corresponds to the identity provider Single Sign-On users having the group attribute value "hr-department", and want to grant the queryreader role to that group on the graph HrGraph:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GSQL &gt; CREATE GROUP HrDepartment PROXY "group=hr-department"
GSQL &gt; GRANT ROLE queryreader ON GRAPH HrGraph TO HrDepartment
Role "queryreader" is successfully granted to user(s): HrDepartment</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_change_password_of_default_user"><a class="anchor" href="#_change_password_of_default_user"></a><strong>Change Password Of Default User</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Don&#8217;t forget to enable User Authorization in TigerGraph by changing the password of the default superuser tigergraph to other than its default value. If you do not change the password, then every time you visit the GraphStudio UI, you will automatically log in as the superuser tigergraph.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GSQL &gt; change password
New Password : ********
Re-enter Password : ********
Password has been changed.
GSQL &gt; exit</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_single_sign_on"><a class="anchor" href="#_testing_single_sign_on"></a>Testing Single Sign-On</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you have finished all configurations for Single Sign-On. Let&#8217;s test it.</p>
</div>
<div class="paragraph">
<p>Visit the GraphStudio UI in your browser. You should see a Login with SSO button appear on top of the login panel:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.25.png" alt="11.25">
</div>
</div>
<div class="paragraph">
<p>Clicking the button will navigate to your identity provider&#8217;s login portal. If you have already logged in there, you will be redirected back to GraphStudio immediately. After about 10 seconds, the verification should finish, and you are authorized to use GraphStudio. If you haven&#8217;t login at your identity provider yet, you will need to log in there. After logging in successfully, you will see your Single Sign-On username when you click the User icon <span class="image"><img src="../../../.gitbook/assets/11.1%20%281%29.png" alt="11.1%20%281%29"></span> at the upper right of the GraphStudio UI.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.26.png" alt="11.26">
</div>
</div>
<div class="paragraph">
<p>If after redirecting back to GraphStudio, you return to the login page with the error message shown below, that means the Single Sign-On user doesn&#8217;t have access to any graph. Please double check your user group proxy rules, and roles you have granted to the groups.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.27.png" alt="11.27">
</div>
</div>
<div class="paragraph">
<p>If your Single Sign-On fails with error message show below, that means either some configuration is inconsistent between TigerGraph and your identity provider, or something unexpected happened.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/11.28.png" alt="11.28">
</div>
</div>
<div class="paragraph">
<p>You can check your GSQL log to investigate. First, find your GSQL log file with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gadmin log gsql
GSQL   : /home/tigergraph/tigergraph/log/gsql/log.INFO</pre>
</div>
</div>
<div class="paragraph">
<p>Then, grep the SAML authentication-related logs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cat /home/tigergraph/tigergraph/log/gsql/log.INFO | grep SAMLAuth</pre>
</div>
</div>
<div class="paragraph">
<p>Focus on the latest errors. Usually the text is self-descriptive. Follow the error message and try to fix TigerGraph or your identity provider&#8217;s configuration. If you encounter any errors that are not clear, please contact <a href="mailto:support@tigergraph.com">support@tigergraph.com</a>.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
