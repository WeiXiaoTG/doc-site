<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Encrypting Data At Rest :: TigerGraph Documentation</title>
    <meta name="generator" content="Antora 3.0.0-alpha.8">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">TigerGraph Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="tigergraph-server" data-version="3.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../intro/introduction.html">TigerGraph Server</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../intro/introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/internal-architecture.html">Internal Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/multigraph-overview.html">Multigraph Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/transaction-and-acid.html">Transaction Processing and ACID Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/comparison-of-editions.html">Comparing TigerGraph Editions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/continuous-availability-overview.html">Continuous Availability Overview</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/docker.html">Get started with Docker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Get started with cloud images</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting-started/cloud-images/aws.html">Get Started on AWS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting-started/cloud-images/azure.html">Get Started on Microsoft Azure</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting-started/cloud-images/gcp.html">Get Started on Google Cloud</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/linux.html">Install TigerGraph on Linux</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Learn GSQL</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../gsql-ref/3.2/tutorials/gsql-101/README.html">GSQL 101</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../gsql-ref/3.2/tutorials/pattern-matching/README.html">Pattern Matching Tutorial</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/hw-and-sw-requirements.html">Hardware and Software Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/install.html">Installlation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/upgrade.html">Upgrade</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/uninstallation.html">Uninstallation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/license.html">Advanced License Issues</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../gsql-shell/gsql-shell.html">The GSQL Shell</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../gsql-shell/using-a-remote-gsql-client.html">Using a Remote GSQL Client</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../user-access/README.html">User Access Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/enabling-user-authentication.html">Enabling User Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/managing-credentials.html">Managing Credentials</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/roles-and-privileges.html">Roles and Privileges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/role-management.html">Role Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/user-management.html">User Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/vlac.html">Vertex-Level Access Control (Beta)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/sso.html">Single Sign-On</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user-access/ldap.html">Lightweight Directory Access Protocol (LDAP)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">High Availability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ha/ha-cluster.html">HA Cluster Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ha/ha-for-gsql-server.html">High Availability Support for GSQL Server</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ha/ha-for-application-server.html">High Availability Support for Application Server</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ha/cluster-commands.html">Cluster Commands</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cluster-resizing/README.html">Cluster Resizing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cluster-resizing/expand-a-cluster.html">Cluster Expansion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cluster-resizing/shrink-a-cluster.html">Cluster Shrinking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cluster-resizing/repartition-a-cluster.html">Cluster Repartition</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../crr/cross-region-replication.html">Cross-Region Replication</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../kubernetes/README.html">Kubernetes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kubernetes/quickstart-with-docker-desktop.html">Quickstart with Docker Desktop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kubernetes/quickstart-with-eks.html">Quickstart with EKS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kubernetes/quickstart-with-aks.html">Quickstart with AKS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kubernetes/quickstart-with-gke.html">Quickstart with GKE</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../data-definition/README.html">Database Definition</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../data-loading/README.html">Data Loading</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-loading/s3-loader-user-guide.html">AWS S3 Loader User Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-loading/kafka-loader-user-guide.html">Kafka Loader User Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-loading/spark-connection-via-jdbc-driver.html">Spark Connection Via JDBC Driver</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../data-querying/README.html">Querying</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../gadmin/management-with-gadmin.html">Managing with gadmin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="encrypting-connections.html">Encrypting Connections</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="encrypting-data-at-rest.html">Encrypting Data At Rest</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file-output-policy.html">File Output Policy</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../import-export/database-import-export.html">Database Import/Export</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../backup-and-restore/backup-and-restore.html">Backup and Restore</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST API Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../API/intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../API/built-in-endpoints.html">Built-in Endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../API/authentication.html">Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../API/json-catalog.html">Built-in Endpoints JSON Catalog</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://tigergraph.freshdesk.com/support/solutions">Knowledge base and FAQs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/system-administration-faqs.html">System Administration FAQs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/log-files.html">Log files</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/troubleshooting-guide.html">Troubleshooting Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Release Notes and Change Logs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/release-notes.html">Release Notes - TigerGraph Server 3.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/change-log.html">Change Log</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/v3.0-removal-of-previously-deprecated-features.html">V3.0 Removal of Previously Deprecated Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../legal/patents-and-third-party-software.html">Patents and Third Party Software</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/configuration-parameters.html">Configuration Parameters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/error-codes.html">Error codes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/list-of-privileges.html">List of Privileges</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">TigerGraph Server</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../tigergraph-gui/3.2/graphstudio/overview.html">GraphStudio and Admin Portal</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-gui/3.2/graphstudio/overview.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../gsql-ref/3.2/intro/intro.html">GSQL Language Reference</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../gsql-ref/3.2/intro/intro.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../tigergraph-cloud/latest/start/README.html">TigerGraph Cloud</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-cloud/latest/start/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../tigergraph-data-science/3.2/intro/overview.html">TigerGraph Data Science Library</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-data-science/3.2/intro/overview.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../intro/introduction.html">TigerGraph Server</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../intro/introduction.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../intro/introduction.html">TigerGraph Server</a></li>
    <li>Security</li>
    <li><a href="encrypting-data-at-rest.html">Encrypting Data At Rest</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/lennessyy/tg-server/edit/main/modules/security/pages/encrypting-data-at-rest.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Encrypting Data At Rest</h1>
<div class="sect1">
<h2 id="_encryption_levels"><a class="anchor" href="#_encryption_levels"></a>Encryption Levels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The TigerGraph graph data store uses a proprietary encoding scheme which both compresses the data and obscures the data unless the user knows the encoding/decoding scheme. In addition, the TigerGraph system supports integration with industry-standard methods for encrypting data when stored in disk ("data at rest").</p>
</div>
<div class="paragraph">
<p>Data at rest encryption can be applied at many different levels. A user can choose to use one or more level.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Encryption Level</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">TigerGraph Support</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hardware</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use specialized hard disks which perform automatic  encryption on write and decryption on read (by  authorized OS users)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invisible to TigerGraph</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kernel-level file system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use Linux built-in utilities to encrypt data.  Root privilege required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invisible to TigerGraph</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User-level file system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use Linux built-in utilities and customized libraries to encrypt data.  Root privilege is not required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invisible to TigerGraph</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_kernel_level_encryption"><a class="anchor" href="#_kernel_level_encryption"></a>Kernel-level Encryption</h3>
<div class="paragraph">
<p>File system encryption employs advanced encryption algorithms. Some tools allow the user to select from a menu of encryption algorithms. It can be done either in kernel mode or user mode. To run in kernel mode, superuser  permission is required.</p>
</div>
<div class="paragraph">
<p>Since Linux 2.6,  device-mapper has been an infrastructure, which provides a generic way to create virtual layers of block devices with transparent encryption blocks using the kernel crypto API.</p>
</div>
<div class="paragraph">
<p>In Ubuntu, full-disk encryption is an option during the OS installation process. For other Linux distributions, the disk can be encrypted with <a href="https://wiki.archlinux.org/index.php/Dm-crypt">dm-encrypt</a>.</p>
</div>
<div class="paragraph">
<p>A commonly used utility is <a href="http://ecryptfs.org/">eCryptfs</a>, which is licensed under GPL, and it is built into some kernels, such as Ubuntu.</p>
</div>
</div>
<div class="sect2">
<h3 id="_user_level_encryption"><a class="anchor" href="#_user_level_encryption"></a>User-Level Encryption</h3>
<div class="paragraph">
<p>If root privilege is not available, a workaround is to use FUSE (Filesystem in User Space) to create a user-level filesystem running on top of the host operating system. While the performance may not be as good as running in kernel mode, there are more options available for customization and tuning.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_1_kernel_mode_file_system_encryption_with_dm_crypt"><a class="anchor" href="#_example_1_kernel_mode_file_system_encryption_with_dm_crypt"></a>Example 1: Kernel-mode file system encryption with dm-crypt</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this example, we use dm-crypt to provide kernel-mode file system encryption. The dm-crypt utility is widely available and offers a choice of encryption algorithms. It also can be set to encrypt various units of storage&#8201;&#8212;&#8201;full disk, partitions, logical volumes, or files.</p>
</div>
<div class="paragraph">
<p>The basic idea of this solution is to create a file, map an encrypted file system to it, and mount it as a storage directory for TigerGraph with R/W permission only to authorized users.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h3>
<div class="paragraph">
<p>Before you start, you will need a Linux machine on which</p>
</div>
<div class="ulist">
<ul>
<li>
<p>you have root permission,</p>
</li>
<li>
<p>the TigerGraph system has not yet been installed,</p>
</li>
<li>
<p>and you have sufficient disk space for the TigerGraph data you wish to encrypt. This may be on your local disk or on a separate disk you have mounted.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_instructions"><a class="anchor" href="#_instructions"></a>Instructions</h3>
<div class="ulist">
<ul>
<li>
<p>Install cryptsetup (cryptsetup is included with Ubuntu, but other OS users may need to install it with yum).</p>
</li>
<li>
<p>Install the TigerGraph system.</p>
</li>
<li>
<p>Grant sudo privilege to the TigerGraph OS user.</p>
</li>
<li>
<p>Stop all TigerGraph services with the following commands:  gadmin stop all -y  gadmin stop admin -y</p>
</li>
<li>
<p>Acting as the tigergraph OS user, run the following export commands to set variables. Replace the placeholders enclosed in angle brackets &lt;&#8230;&#8203;&gt; with the values of your choice:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># The username for TigerGraph Database System, for example: tigergraph
export db_user='&lt;username&gt;'

# The path of encrypted file to be created for TigerGraph storage, for example: /home/tigergraph/secretfs
export encrypted_file_path='&lt;path-to-encrypted-file&gt;'

# The size of encrypted file to be created (used by dd command), for example: 60G
export encrypted_file_size=&lt;storage-size&gt;

# The password for the encrypted file, for example: DataAtRe5tPa55w0rd
export encryption_password='&lt;password&gt;'

# The root directory for tigergraph, for example: $HOME/tigergraph
export tigergraph_data_root="&lt;tigergraph-data-root&gt;"

# Set the first available loop device for encrypted file mapping
export loop_device=$(losetup -f)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a file for TigerGraph data storage.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">dd of=$encrypted_file_path bs=$encrypted_file_size count=0 seek=1</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the permission of the file so that only the owner of the file (that is, only the tigergraph user who created the file in the previous step) will be able to access it:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">chmod 600 $encrypted_file_path</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Associate a loopback device with the file:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo losetup $loop_device $encrypted_file_path</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Encrypt storage in the device. cryptsetup will use the Linux device mapper to create, in this case, $encrypted_file_path . Initialize the volume and set a password interactively with the password you set to $encryption_password :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo cryptsetup -y luksFormat $loop_device</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are trying to automate the process with a script running with root TTY session , you may use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "$encryption_password" | cryptsetup -y luksFormat $loop_device</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the partition, and create a mapping to $encrypted_file_path :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo cryptsetup luksOpen $loop_device tigergraph_gstore</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are trying to automate the process with a script running with root TTY session , you may use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "$encryption_password" | cryptsetup luksOpen $loop_device tigergraph_gstore</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Clear the password from bash variables and bash history.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>{% hint style="warning" %}
 The following commands may clear your previous bash histories as well. Instead, you may edit ~/.bash_history to selectively delete the related entries.
{% endhint %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">unset encryption_password
history -c
history -w</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a file system and verify its status:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo mke2fs -j -O dir_index /dev/mapper/tigergraph_gstore</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Mount the new file system to /mnt/secretfs:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo mkdir -p /mnt/secretfs
sudo mount /dev/mapper/tigergraph_gstore /mnt/secretfs</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the permission to 700 so that only $db_user has access to the file system:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo chmod -R 700 /mnt/secretfs
sudo chown -R $db_user:$db_user /mnt/secretfs</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Move the original TigerGraph files to the encrypted filesystem and make a symbolic link. If you wish to encrypt only the TigerGraph data store (called gstore), use the following commands:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mv $tigergraph_data_root/gstore /mnt/secretfs/gstore
ln -s /mnt/secretfs/gstore $tigergraph_data_root/gstore</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are other TigerGraph files which you might also consider to be sensitive and wish to encrypt.  These include the dictionary, kafka data files, and log files.  You could selectively identify files to protect or you could encrypt the entire TigerGraph folder(App/Data/Log/TempRoot). In this case, simply move  $tigergraph_data_root instead of $tigergraph_data_root/gstore.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mv $tigergraph_data_root /mnt/secretfs/tigergraph
ln -s /mnt/secretfs/tigergraph $tigergraph_data_root</code></pre>
</div>
</div>
<div class="paragraph">
<p>The data of TigerGraph data is now stored in an encrypted filesystem.  It will be automated decrypted when the tigergraph user (and only this user) accesses it.</p>
</div>
<div class="paragraph">
<p>To automatically deploy this encryption solution, you may</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Chain all the steps as a bash script</p>
</li>
<li>
<p>Remove all "sudo" since the script will be running as root.</p>
</li>
<li>
<p>Run the script as root user after TigerGraph Installation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>{% hint style="warning" %}
 The setup scripts contain your encryption password. To follow good security procedures, do not leave your password in plaintext format in any files on your disk. Either remove the setup scripts or edit out the password.
{% endhint %}</p>
</div>
</div>
<div class="sect2">
<h3 id="_performance_evaluation"><a class="anchor" href="#_performance_evaluation"></a>Performance Evaluation</h3>
<div class="paragraph">
<p>Encryption is usually CPU-bound rather than I/O-bound. If CPU usage reamains below 100%, encryption should not cause much  performance slowdown. A performance test using both small and large queries supports this prediction: for small (~1 sec) and large (~100 sec) queries, there is a ~5% slowdown due to filesystem encryption.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><strong>GSE Cold Start (read)</strong></th>
<th class="tableblock halign-left valign-top"><strong>Load Data (write)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">original</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">45s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">809s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">encrypted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">47s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">854s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">% slowdown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.4%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.8%</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>We used the TPC-H dataset with scale factor 10 ( <a href="http://www.tpc.org/tpch/" class="bare">http://www.tpc.org/tpch/</a>). The data size is 23GB after loading into TigerGraph..The write test (data loading) was done by running a loading job and then killing the GPE with SIGTERM (to exit gracefully) to ensure that all kafka data is consumed.The read test (GSE cold start) measures the time from "gadmin start gse" until "online" appears in "gadmin status gse".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_2_encrypting_data_on_amazon_ec2"><a class="anchor" href="#_example_2_encrypting_data_on_amazon_ec2"></a>Example 2: Encrypting Data on Amazon EC2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Major cloud service providers often provide their own methodologies for encrypting data at rest. For Amazon EC2, we recommend users start by reading the AWS Security Blog: <a href="https://aws.amazon.com/blogs/security/how-to-protect-data-at-rest-with-amazon-ec2-instance-store-encryption/">How to Protect Data at Rest with Amazon EC2 Instance Store Encryption</a>.</p>
</div>
<div class="paragraph">
<p>In this section, we provide a simple example for configuring file system encryption for a TigerGraph running on Amazon EC2. The steps are based on those given in <a href="https://aws.amazon.com/blogs/security/how-to-protect-data-at-rest-with-amazon-ec2-instance-store-encryption/">How to Protect Data at Rest with Amazon EC2 Instance Store Encryption</a>, with some additions and modifications.</p>
</div>
<div class="paragraph">
<p>The basic idea of this solution is to create a file, map an encrypted file system to it, and mount it as a storage directory for TigerGraph with permission only to authorized users.</p>
</div>
<div class="paragraph">
<p>{% hint style="danger" %}
 Angle brackets &lt;&#8230;&#8203;&gt; are used to mark placeholders which you should replace with your own values (without the angle brackets).
{% endhint %}</p>
</div>
<div class="sect2">
<h3 id="_prerequisites_2"><a class="anchor" href="#_prerequisites_2"></a><strong>Prerequisites</strong></h3>
<div class="paragraph">
<p>Make sure you have installed and configured <a href="https://aws.amazon.com/cli/">AWS CLI</a>with keys locally.</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_an_s3_bucket"><a class="anchor" href="#_create_an_s3_bucket"></a><strong>Create an S3 Bucket</strong></h3>
<div class="paragraph">
<p>{% code title="from Amazon Data-at-Rest blog" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Sign in to the S3 console and choose Create Bucket .
In the Bucket Name box, type your bucket name and then choose Create .
You should see the details about your new bucket in the right pane.</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
<div class="sect2">
<h3 id="_configure_iam_roles_and_permission_for_the_s3_bucket"><a class="anchor" href="#_configure_iam_roles_and_permission_for_the_s3_bucket"></a><strong>Configure IAM roles and permission for the S3 bucket</strong></h3>
<div class="paragraph">
<p>{% code title="from Amazon Data-at-Rest blog" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">1.Sign in to the AWS Management Console and navigate to the IAM console . In the navigation pane, choose Policies , choose Create Policy . Choose the JSON tab, paste in the following JSON code, and then choose Review Policy . Name and describe the policy, and then choose Create Policy to save your work. For more details, see Creating Customer Managed Policies .

{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "VisualEditor0",
            "Effect": "Allow",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::&lt;your-bucket-name&gt;/LuksInternalStorageKey"
        }
    ]
}
The preceding policy grants read access to the bucket where the encrypted password is stored. This policy is used by the EC2 instance, which requires you to configure an IAM role. You will configure KMS permissions later in this post.
(The following instructions have been updated since the original blog post.)

2."Select type of trusted entity: Choose AWS service .
3."Select the service that will use this role": Choose EC2 then choose Next: Permissions.
4.Choose the policy you created in Step 1 and then choose Next: Review.
5.On the Create role page, type your role name , a Role description, and choose Create role .
6.The newly created IAM role is now ready. You will use it when launching new EC2 instances, which will have the permission to access the encrypted password file in the S3 bucket.</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_kms_key_optional"><a class="anchor" href="#_create_a_kms_key_optional"></a>Create a KMS Key (optional)</h3>
<div class="paragraph">
<p>If you don&#8217;t have a KMS key, you can create it first:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the <a href="https://console.aws.amazon.com/iam/home">IAM console</a>, choose Encryption keys from the navigation pane.</p>
</li>
<li>
<p>Select Create Key , and type in &lt;your-key-alias&gt; <em>**</em></p>
</li>
<li>
<p>For Step 2 and Step 3 , see <a href="https://docs.aws.amazon.com/kms/latest/developerguide/create-keys.htmlfor" class="bare">https://docs.aws.amazon.com/kms/latest/developerguide/create-keys.htmlfor</a> advice.</p>
</li>
<li>
<p>In Step 4 : Define Key Usage Permissions , select &lt;your-role-name&gt;</p>
</li>
<li>
<p>The role now has permission to use the key.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/screen-shot-2018-10-01-at-11.20.59-pm.png" alt="Step 2. Create Key">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encrypt_a_secret_password_with_kms_and_store_it_in_the_s3_bucket"><a class="anchor" href="#_encrypt_a_secret_password_with_kms_and_store_it_in_the_s3_bucket"></a>Encrypt a secret password with KMS and store it in the S3 bucket</h3>
<div class="paragraph">
<p>{% code title="from Amazon Data-at-Rest blog" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Next, use KMS to encrypt a secret password. To encrypt text by using KMS, you must use AWS CLI . AWS CLI is installed by default on EC2 Amazon Linux instances and you can install it on Linux, Windows, or Mac computers.

To encrypt a secret password with KMS and store it in the S3 bucket:

From the AWS CLI, type the following command to encrypt a secret password by using KMS (replace &lt;your-region&gt; with your region). You must have the right permissions in order to create keys and put objects in S3 (for more details, see Using IAM Policies with AWS KMS ). In this example, I have used AWS CLI on the Linux OS to encrypt and generate the encrypted password file.
aws --region &lt;your-region&gt; kms encrypt --key-id 'alias/&lt;your-key-alias&gt;' --plaintext '&lt;your-password&gt;' --query CiphertextBlob --output text | base64 --decode &gt; LuksInternalStorageKey

aws s3 cp LuksInternalStorageKey s3://&lt;your-bucket-name&gt;/LuksInternalStorageKey
The preceding commands encrypt the password (Base64 is used to decode the cipher text). The command outputs the results to a file called LuksInternalStorageKey. It also creates a key alias (key name) that makes it easy to identify different keys; the alias is called &lt;your-key-alias&gt; . The file is then copied to the S3 bucket created earlier in this post.</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
<div class="sect2">
<h3 id="_configure_ec2_with_role_and_launch_configurations"><a class="anchor" href="#_configure_ec2_with_role_and_launch_configurations"></a>Configure EC2 with role and launch configurations</h3>
<div class="paragraph">
<p>In this section, you launch a new EC2 instance with the new IAM role and a bootstrap script that executes the steps to encrypt the file system.</p>
</div>
<div class="paragraph">
<p>{% hint style="danger" %}
 The script in this section requires root permission, and it cannot be run manually through an ssh tunnel or by an unprivileged user.
{% endhint %}</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../.gitbook/assets/13.2.png" alt="13.2">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <a href="https://console.aws.amazon.com/ec2/v2/home">EC2 console</a>, launch a new instance (see <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/launching-instance.html">this tutorial</a>for more details). Amazon Linux AMI 2017.09.1 (HVM), SSD Volume Type (If NOT using Amazon Linux AMI, a script the installs python, pip and AWS CLI needs to be added in the beginning).</p>
</li>
<li>
<p>In Step 3: Configure Instance Details</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In IAM role , choose &lt;your-role-name&gt;</p>
</li>
<li>
<p>In User Data , paste the following code block after replacing the placeholders with your values and appending TigerGraph installation script</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>{% code title="Encryption bootstrap script" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">#!/bin/bash

db_user=tigergraph

## Initial setup to be executed on boot
##====================================
# Create an empty file. This file will be used to host the file system.
# In this example we create a &lt;disk-size&gt; (for example: 60G) file at &lt;path-to-encrypted-file&gt; (for example: /home/tigergraph/gstore_enc).
dd of=&lt;path-to-encrypted-file&gt; bs=&lt;disk-size&gt; count=0 seek=1

# Lock down normal access to the file.
chmod 600 &lt;path-to-encrypted-file&gt;

# Associate a loopback device with the file.
losetup /dev/loop0 &lt;path-to-encrypted-file&gt;

#Copy encrypted password file from S3. The password is used to configure LUKE later on.
aws s3 cp s3://&lt;your-bucket-name&gt;/LuksInternalStorageKey .

# Decrypt the password from the file with KMS, save the secret password in LuksClearTextKey
LuksClearTextKey=$(aws --region &lt;your-region&gt; kms decrypt --ciphertext-blob fileb://LuksInternalStorageKey --output text --query Plaintext | base64 --decode)

# Encrypt storage in the device. cryptsetup will use the Linux
# device mapper to create, in this case, /dev/mapper/tigergraph_gstore.
# Initialize the volume and set an initial key.
echo "$LuksClearTextKey" | cryptsetup -y luksFormat /dev/loop0

# Open the partition, and create a mapping to /dev/mapper/tigergraph_gstore.
echo "$LuksClearTextKey" | cryptsetup luksOpen /dev/loop0 tigergraph_gstore

# Clear the LuksClearTextKey variable because we don't need it anymore.
unset LuksClearTextKey

# Create a file system and verify its status.
mke2fs -j -O dir_index /dev/mapper/tigergraph_gstore

# Mount the new file system to /mnt/secretfs.
mkdir -p /mnt/secretfs
mount /dev/mapper/tigergraph_gstore /mnt/secretfs

# create user tigergraph
adduser $db_user

# Change the permission so that only tigergraph has access to the file system
chmod -R 700 /mnt/secretfs
chown -R $db_user:$db_user /mnt/secretfs

# Install TigerGraph
# Run the one-command installation script with TigerGraphh root path under /mnt/secretfs</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>It may take a few minutes for the script to complete after system launch.</p>
</div>
<div class="paragraph">
<p>Then, you should be able to launch one or more EC2 machines with an encrypted folder under /mnt/secretfs that only OS user <em>tigergraph</em> can access.</p>
</div>
</div>
<div class="sect2">
<h3 id="_performance"><a class="anchor" href="#_performance"></a>Performance</h3>
<div class="paragraph">
<p>Encryption is usually CPU-bound rather than I/O bound. If CPU usage is below 100%, TigerGraph tests show no significant performance downgrade.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
