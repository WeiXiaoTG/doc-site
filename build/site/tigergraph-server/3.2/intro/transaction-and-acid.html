<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Transaction Processing and ACID Support :: TigerGraph Server User Guide</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">TigerGraph Server User Guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="tigergraph-server" data-version="3.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../installation/install.html">TigerGraph Server User Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="internal-architecture.html">TigerGraph Internal Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/docker.html">Getting started with Docker</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/install.html">Installation Guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">The GSQL Shell</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../gsql-shell/using-a-remote-gsql-client.html">Using a Remote GSQL Client</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Definition</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-definition/README.html">Data Definition</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data loading</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-loading/s3-loader-user-guide.html">AWS S3 Loader User Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-loading/spark-connection-via-jdbc-driver.html">Spark Connection Via JDBC Driver</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">System management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../administration/README.html">System Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../administration/management-with-gadmin.html">Managing with gadmin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security/user-access/README.html">User Access Management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Backup and Restore</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../backup-and-restore/backup-and-restore.html">Backup and Restore</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST API Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../API/intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../API/built-in-endpoints.html">Built-in Endpoints</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">References</span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">TigerGraph Server User Guide</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../installation/install.html">TigerGraph Server User Guide</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../installation/install.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../tigergraph-gui/3.2/graphstudio/overview.html">TigerGraph Web UI Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-gui/3.2/graphstudio/overview.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../installation/install.html">TigerGraph Server User Guide</a></li>
    <li><a href="transaction-and-acid.html">Transaction Processing and ACID Support</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/lennessyy/tg-server/edit/main/modules/intro/pages/transaction-and-acid.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Transaction Processing and ACID Support</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document describes the transactional support provided by the TigerGraph platform. A TigerGraph <em>*transaction*</em> is a sequence of operations which acts as a single logical unit of work. A <em>*read-only operation*</em> in TigerGraph does not change any vertex/edge attribute value and doesn&#8217;t insert any new or delete any existing vertex/edge. An <em>*update operation*</em> in TigerGraph is an operation which either changes some vertex/edge attribute value or insert some new or delete some existing vertex/edge.</p>
</div>
<div class="paragraph">
<p>The TigerGraph system provides full ACID transactions with sequential consistency. Transactions are defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each GSQL query is a transaction. Each query may have multiple read or write operations.</p>
</li>
<li>
<p>Each REST&#43;&#43; GET, POST, or DELETE operation (which may have multiple update operations within it) is a transaction.</p>
</li>
</ul>
</div>
<h4 id="_atomicity" class="discrete"><strong>Atomicity</strong> <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-Atomicity"></a></h4>
<div class="paragraph">
<p>A transaction with update operations may insert/delete multiple vertices/edges or update the attribute values of multiple edges/vertices.  Such update requests are &#8220;all or nothing&#8221;: either all changes are successful, or none is successful.</p>
</div>
<h4 id="_consistency" class="discrete"><strong>Consistency</strong> <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-Consistency"></a></h4>
<div class="paragraph">
<p>The TigerGraph system provides traditional ACID consistency: A transaction can include data validation rules. The data validation rules can ensure any transaction will bring the system from one valid state to another.</p>
</div>
<div class="paragraph">
<p>The TigerGraph system also provides distributed system Sequential Consistency: every replica of the data performs the same operations in the same order. This is one of the strongest forms of consistency available, stronger than causal consistency, for example.</p>
</div>
<h4 id="_isolation_level" class="discrete"><strong>Isolation Level</strong> <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-IsolationLevel"></a></h4>
<div class="paragraph">
<p>TigerGraph supports the Serializable isolation level, the strongest form of isolation. Internally, TigerGraph uses MVCC to implement the isolation. MVCC, or Multi-Version Concurrency Control, makes use of multiple snapshots of portions of the database state in order to support isolated concurrent operations.  In principle, there can be one snapshot per read or write operation.</p>
</div>
<h4 id="_no_dirty_reads" class="discrete"><strong>No Dirty Reads</strong> <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-NoDirtyReads"></a></h4>
<div class="paragraph">
<p>A read-only transaction R1 will not see any changes made by an uncommitted update transaction, whether that update transaction was submitted before or after R1 was submitted to the system.</p>
</div>
<h4 id="_repeatable_reads" class="discrete"><strong>Repeatable reads</strong>  <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-Repeatablereads"></a></h4>
<div class="paragraph">
<p>Multiple same reads in a single transaction T1 will get the same results, even if there are update transactions which change vertex or edge attribute values read by T1 during T1&#8217;s duration.</p>
</div>
<h4 id="_no_phantom_reads" class="discrete"><strong>No phantom reads</strong> <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-Nophantomreads"></a></h4>
<div class="paragraph">
<p>Multiple reads in a single read-only transaction T1 will get the same results, even if there are update transactions which deleted/inserted vertices or edges read by T1 during T1&#8217;s duration.</p>
</div>
<h4 id="_durability" class="discrete"><strong>Durability</strong>  <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-Durability"></a></h4>
<div class="paragraph">
<p>Committed transactions are written to disk (SSD or HDD). The TigerGraph platform implements write-ahead logging (WAL) to provide durability.</p>
</div>
<h4 id="_tigergraph_internal_snapshot_implementation" class="discrete"><strong>TigerGraph internal Snapshot Implementation</strong>  <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-TigerGraphinternalSnapshotImplementation"></a></h4>
<div class="paragraph">
<p>The TigerGraph platform uses Snapshot/MVCC (Multi-version Concurrency Control) to implement isolation of concurrent operations.  At the high level, the platform can temporarily maintain multiple versions or snapshots of the graph data. When a transaction T1 is submitted to the system, it will work on the last consistent snapshot of the graph which has all the changes made by transactions committed before T1 was submitted but has no changes made by any transaction not yet committed when T1 was submitted. The version of the graph T1 is working on will not be changed by any transactions other than T1 , even if they commit before T1 is finished.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_scenarios"><a class="anchor" href="#_example_scenarios"></a>Example Scenarios</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let us examine a few transaction processing scenarios.</p>
</div>
<h4 id="_scenario_1_read_write" class="discrete">Scenario 1 Read - Write <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-Scenario1Read-Write"></a></h4>
<div class="paragraph">
<p>A read-only transaction R1 is running. Before R1 finishes, an update transaction W2 comes in.  W2 might finish before R1 is finished.  But R1 will not see the changes made by W2 before W2 is committed (no dirty reads).  Even if W2 is committed before R1 is finished, if R1 reads the same part of the graph multiple times, it will not see the changes made by W2 (repeatable reads).  There are no phantom reads either. This is because the graph version R1 is working on cannot be changed by any of the W2 transaction aforementioned. Bottom line: If W2 starts when R1 is not yet committed, R1 will see results as though W2 did not exist.</p>
</div>
<div class="imageblock">
<div class="content">
<img src=".gitbook/assets/1%20%282%29.png" alt="1%20%282%29">
</div>
</div>
<h4 id="_scenario_2_write_read" class="discrete">Scenario 2  Write - Read</h4>
<div class="paragraph">
<p>An update transaction W1 is running. Before W1 is committed, a read-only transaction R2 comes in.  R2 will not wait for W1 to finish and will be executed as if there is no W1. Later. even if W1 finishes and commits before R2 is finished, R2 will not see any changes made by W1.  This is because the graph version R2 works on is 'fixed' at the time when R2 is submitted and will not include the changes to be made by W1. Bottom line: If R2 starts when W1 is not yet committed, R2 will see results as though W1 did not exist.</p>
</div>
<div class="imageblock">
<div class="content">
<img src=".gitbook/assets/2%20%281%29.png" alt="2%20%281%29">
</div>
</div>
<h4 id="_scenario_3_write_write" class="discrete">Scenario 3  Write - Write <a id="TigerGraphTransactionProcessingandACIDPropertiesSupport-Scenario3Write-Write"></a></h4>
<div class="paragraph">
<p>An update transaction W1 is running. Before W1 finishes, a new update request W2 comes in.  W2 will wait for W1 to finish before it is executed. When multiple update transactions come in, they will be executed sequentially by the system according to the time they are received by the system.</p>
</div>
<div class="imageblock">
<div class="content">
<img src=".gitbook/assets/3%20%281%29%20%281%29.png" alt="3%20%281%29%20%281%29">
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
