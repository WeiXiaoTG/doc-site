<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Declaration and Assignment Statements :: TigerGraph Documentation</title>
    <meta name="generator" content="Antora 3.0.0-alpha.8">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">TigerGraph Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="gsql-ref" data-version="3.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../intro/intro.html">GSQL Language Reference</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../intro/intro.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tutorials/gsql-101/README.html">GSQL 101</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/gsql-101/get-set.html">Get Set</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/gsql-101/define-a-schema.html">Define a Schema</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/gsql-101/load-data-gsql-101.html">Load Data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/gsql-101/built-in-select-queries.html">Run Built-in Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/gsql-101/parameterized-gsql-query.html">Develop Parameterized Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/gsql-101/review.html">Review</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tutorials/pattern-matching/README.html">Pattern Matching Tutorial</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/pattern-matching/get-set.html">Get Set</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/pattern-matching/load-data.html">Load Data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/pattern-matching/one-hop-patterns.html">One-hop patterns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/pattern-matching/repeating-a-pattern.html">Repeating a 1-Hop Pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/pattern-matching/multiple-hop-and-accumulation.html">Multiple Hop Patterns and Accumulation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/pattern-matching/example.html">Example - A Recommender</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tutorials/pattern-matching/adv/README.html">Advanced Features</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/pattern-matching/adv/per-clause.html">Per Clause (Beta)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/pattern-matching/adv/conjunctive-pattern-matching.html">Conjunctive Pattern Matching (Beta)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/pattern-matching/adv/dml.html">Data Modification</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/pattern-matching/summary.html">Summary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Database definition &amp; Loading</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ddl-and-loading/system-and-language-basics.html">System &amp; Language Basics</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ddl-and-loading/defining-a-graph-schema.html">Defining a Graph Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ddl-and-loading/modifying-a-graph-schema.html">Modifying a Graph Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ddl-and-loading/creating-a-loading-job.html">Creating a Loading Job</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ddl-and-loading/running-a-loading-job.html">Running a Loading Job</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendix</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ddl-and-loading/appendix/keywords-and-reserved-words.html">DDL Keywords &amp; Reserved Words</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#appendix/gsql-start-to-end-process.adoc">appendix/gsql-start-to-end-process.adoc</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Querying</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction-query.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="query-operations.html">CREATE/INTERPRET/INSTALL/RUN QUERY</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="distributed-query-mode.html">Distributed Query Mode</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="data-types.html">Data Types</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="accumulators.html">Accumulators</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="operators-and-expressions.html">Operators and Expressions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="func/README.html">Functions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/aggregation-functions.html">Aggregation Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/datetime-functions.html">Datetime Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/edge-methods.html">Edge Methods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/json-object-methods.html">JSON Object Methods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/jsonarray-methods.html">JSON Array Methods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/mathematical-functions.html">Mathematical Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/miscellaneous-functions.html">Miscellaneous Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/query-user-defined-functions.html">Query User-Defined Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/string-functions.html">String Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/type-conversion-functions.html">Type Conversion Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="func/vertex-methods.html">Vertex Functions</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="declaration-and-assignment-statements.html">Declaration and Assignment Statements</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="select-statement/README.html">SELECT Statement</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="select-statement/sql-like-select-statement.html">SQL-like SELECT statement</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="control-flow-statements.html">Control Flow Statements</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="data-modification-statements.html">Data Modification Statements</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="output-statements-and-file-objects.html">Output Statements and FILE Objects</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="exception-statements.html">Exception Statements</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="comments.html">Comments</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendix</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appendix-query/common-errors-and-problems.html">Common Errors and Problems</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appendix-query/complete-formal-syntax.html">Formal Grammar for Query Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appendix-query/query-language-reserved-words.html">Query Language Reserved Words</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appendix-query/example-graphs.html">Example Graphs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appendix-query/interpreted-gsql-limitations.html">Interpreted GSQL Limitations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">GSQL Language Reference</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../tigergraph-gui/3.2/graphstudio/overview.html">GraphStudio and Admin Portal</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-gui/3.2/graphstudio/overview.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../intro/intro.html">GSQL Language Reference</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../intro/intro.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../tigergraph-cloud/latest/start/README.html">TigerGraph Cloud</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-cloud/latest/start/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../tigergraph-data-science/3.2/intro/overview.html">TigerGraph Data Science Library</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-data-science/3.2/intro/overview.html">3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../tigergraph-server/3.2/intro/introduction.html">TigerGraph Server</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tigergraph-server/3.2/intro/introduction.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../intro/intro.html">GSQL Language Reference</a></li>
    <li>Querying</li>
    <li><a href="declaration-and-assignment-statements.html">Declaration and Assignment Statements</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/lennessyy/gsql/edit/main/modules/querying/pages/declaration-and-assignment-statements.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Declaration and Assignment Statements</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In GSQL, different types of variables and objects follow different rules when it comes to variable declaration and assignment. This section discusses the different types of declaration and assignment statements and covers the following subset of the EBNF syntax:</p>
</div>
<div class="paragraph">
<p>{% code title="EBNF" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-erlang hljs" data-lang="erlang">## Declarations ##
accumDeclStmt :=
          accumType localAccumName ["=" constant]
                    ["," localASccumName ["=" constant]]*
        | [STATIC] accumType globaAccumName ["=" constant]
                    ["," GlobalAccumName ["=" constant]]*
localAccumName := "@"accumName;
globalAccumName := "@@"accumName;

baseDeclStmt    := baseType name ["=" constant] ["," name ["=" constant]]*
fileDeclStmt := FILE fileVar "(" filePath ")"
fileVar := name

localVarDeclStmt := baseType varName "=" expr

vSetVarDeclStmt := vertexSetName ["(" vertexType ")"] "=" (seedSet | simpleSet | selectBlock)

simpleSet := vertexSetName
           | "(" simpleSet ")"
           | simpleSet (UNION | INTERSECT | MINUS) simpleSet

seedSet := "{" [seed ["," seed ]*] "}"
seed := '_'
      | ANY
      | vertexSetName
      | globalAccumName
      | vertexType ".*"
      | paramName
      | "SelectVertex" selectVertParams

selectVertParams := "(" filePath "," columnId "," (columnId | name) ","
          stringLiteral "," (TRUE | FALSE) ")" ["." FILTER "(" condition ")"]

columnId := "$" (integer | stringLiteral)

## Assignment Statements ##
assignStmt := name "=" expr
            | name "." attrName "=" expr

attrAccumStmt := name "." attrName "+=" expr

lAccumAssignStmt := vertexAlias "." localAccumName ("+="| "=") expr

gAccumAssignStmt :=  globalAccumName ("+=" | "=") expr

loadAccumStmt := globalAccumName "=" "{" LOADACCUM loadAccumParams
                                  ["," LOADACCUM loadAccumParams]* "}"

loadAccumParams := "(" filePath "," columnId ["," columnId]* ","
          stringLiteral "," (TRUE | FALSE) ")" ["." FILTER "(" condition ")"]

## Function Call Statement ##
funcCallStmt := name ["&lt;" type ["," type]* "&gt;"] "(" [argList] ")"
              | globaAccumName ("." funcName "(" [argList] ")")+
              | "reset_collection_accum" "(" accumName ")"

argList := expr ["," expr]*</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_variable_scopes"><a class="anchor" href="#_variable_scopes"></a>Variable scopes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Different types of variable declarations use different scoping rules. There are two types of scoping rules in a GSQL query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="declaration-and-assignment-statements.md#block-scoping">Block scoping</a></p>
</li>
<li>
<p><a href="declaration-and-assignment-statements.md#global-scoping">Global scoping</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_block_scoping"><a class="anchor" href="#_block_scoping"></a>Block scoping</h3>
<div class="paragraph">
<p>In GSQL, curly brackets, as well as <code>IF .. THEN</code>, <code>ELSE</code>, <code>WHILE ... DO</code>, <code>FOREACH ... DO</code> statements create a block. A <code>SELECT</code> statement also creates a block. A block-scoped variable declared inside a block scope is only accessible inside that scope.</p>
</div>
<div class="paragraph">
<p>Additionally, variables declared in a lower scope can use the same name as a variable already declared in a higher scope. The lower-scope declaration will take precedence over the higher-scope declaration until the end of the lower scope.</p>
</div>
<div class="paragraph">
<p>The following types of variables use block scoping:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="accumulators.html" class="page">Accumulators</a></p>
</li>
<li>
<p><a href="declaration-and-assignment-statements.md#base-type-variables">Base type variables</a></p>
</li>
<li>
<p><a href="declaration-and-assignment-statements.md#local-base-type-variables">Local base type variables</a></p>
</li>
<li>
<p><a href="declaration-and-assignment-statements.md#file-object-declaration">File objects</a></p>
</li>
<li>
<p><a href="select-statement/#aliases-and-accum-post-accum-iteration-model">Vertex or edge aliases</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_global_scoping"><a class="anchor" href="#_global_scoping"></a>Global scoping</h3>
<div class="paragraph">
<p>A global-scoped variable is always accessible anywhere in the query once it has been declared regardless of where it is declared. One also cannot declare another variable with the same name as a  global-scoped variable that has already been declared.</p>
</div>
<div class="paragraph">
<p>The following types of variables use global scoping:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="declaration-and-assignment-statements.md#vertex-set-variable-declaration-and-assignment">Vertex set variables</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_declaration_statements"><a class="anchor" href="#_declaration_statements"></a>Declaration Statements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are six types of variable declarations in a GSQL query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accumulator</p>
</li>
<li>
<p>Base type variable</p>
</li>
<li>
<p>Local base type variable</p>
</li>
<li>
<p>Vertex set</p>
</li>
<li>
<p>File object</p>
</li>
<li>
<p>Vertex or edge aliases</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first five types each have their own declaration statement syntax and are covered in this section. Aliases are declared implicitly in a <code>SELECT</code> statement.</p>
</div>
<div class="sect2">
<h3 id="_accumulators"><a class="anchor" href="#_accumulators"></a>Accumulators</h3>
<div class="paragraph">
<p>Accumulator declaration is discussed in <a href="accumulators.md#declaration-of-accumulators">Accumulators</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_base_type_variables"><a class="anchor" href="#_base_type_variables"></a>Base type variables</h3>
<div class="paragraph">
<p>In a GSQL query body, variables holding values of types <code>INT</code>, <code>UINT</code>, <code>FLOAT</code>, <code>DOUBLE</code>, <code>BOOL</code>, <code>STRING</code>, <code>DATETIME</code>, <code>VERTEX</code>, <code>EDGE</code>, <code>JSONOBJECT</code> and <code>JSONARRAY</code> are called base type variables. The scope of a base type variable is from the point of declaration until the end of the block where its declaration took place.</p>
</div>
<div class="paragraph">
<p>{% code title="EBNF for base type variable declaration" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">baseVarDeclStmt    := baseType name ["=" expr]["," name ["=" expr]]*</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>A base type variable can be declared and accessed anywhere in the query. To declare a base type variable, specify the data type and the variable name. Optionally, you can initialize the variable by assigning it a value with the assignment operator (<code>=</code>) and the desired value on the right side. You can declare multiple variables of the same type in a single declaration statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">CREATE QUERY baseTypeVariable() {
    STRING a;
    DOUBLE num1, num2 = 3.2;
    INT year = 2020, month = 12, day = 115;
    INT b = rand(5);
    PRINT a, b, num;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a base type variable is assigned a new value in an <code>ACCUM</code> or <code>POST-ACCUM</code> clause, the change will not take place until exitng the clause. Therefore, if there are multiple assignment statements for the same base type variable in an <code>ACCUM</code> or <code>POST-ACCUM</code> clause, only the last one will take effect.</p>
</div>
<div class="paragraph">
<p>For example, in the following query, a base type variable is assigned a new value in the <code>ACCUM</code> clause, but the change will not take place until the clause ends. Therefore, the accumulator will not receive the value and will hold a value of 0 at the end of the query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE QUERY baseTypeVariable(vertex&lt;person&gt; m1) FOR GRAPH socialNet {
  MaxAccum&lt;INT&gt; @@maxDateGlob;
  DATETIME dt;

  allUser = {person.*};
  allUser = SELECT src
            FROM allUser:src - (liked:e) -&gt; post
            ACCUM
            dt = e.actionTime,           # dt isn't updated yet
            @@maxDateGlob += datetime_to_epoch(dt);
  PRINT @@maxDateGlob, dt;  # @@maxDateGlob will be 0
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_local_base_type_variables"><a class="anchor" href="#_local_base_type_variables"></a>Local base type variables</h3>
<div class="paragraph">
<p>Base type variables declared in a DML-sub statement, such as in a statement inside a <code>ACCUM</code>, <code>POST-ACCUM</code>, or <code>UPDATE SET</code> clause, are called <em>local</em> <em>base type variables</em>.</p>
</div>
<div class="paragraph">
<p>Local base type variables are block-scoped and are accessible in the block where they are declared only. Within a local base type variable&#8217;s scope, another local base type variable with the same name cannot be declared at the same level.  However, a new local base type variable with the same name can be declared at a lower level (i.e., within a nested <code>SELECT</code> or <code>UPDATE</code> statement). The lower declaration takes precedence at the lower level.</p>
</div>
<div class="paragraph">
<p>In a <code>POST-ACCUM</code> clause, each local base type variable may only be used in source vertex statements or only in target vertex statements, not both.</p>
</div>
<div class="paragraph">
<p>{% code title="EBNF for local base type variable declaration and initialization" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">localVarDeclStmt := baseType varName "=" expr</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>Local base type variables are not subject to the assignment restrictions of regular base type variables. Their values can be updated inside an <code>ACCUM</code> or <code>POST-ACCUM</code> clause and the change will take place immediately.</p>
</div>
<div class="sect3">
<h4 id="_example"><a class="anchor" href="#_example"></a>Example:</h4>
<div class="paragraph">
<p>{% code title="Base type variable declaration in DML statements" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql"># An example showing a local base type variable succeeds
# where a base type variable fails
CREATE QUERY localVariable(vertex&lt;person&gt; m1) FOR GRAPH socialNet {
  MaxAccum&lt;INT&gt; @@maxDate, @@maxDateGlob;
  DATETIME dtGlob;

  allUser = {person.*};
  allUser = SELECT src
            FROM allUser:src - (liked:e) -&gt; post
            ACCUM
            DATETIME dt = e.actionTime,      # Declare and assign local dt
            dtGlob = e.actionTime,           # dtGlob isn't updated yet
            @@maxDate     += datetime_to_epoch(dt),
            @@maxDateGlob += datetime_to_epoch(dtGlob);
  PRINT @@maxDate, @@maxDateGlob, dtGlob;  # @@maxDateGlob will be 0
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>{% code title="localVariable Query Results" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">GSQL &gt; RUN QUERY localVariable("person1")
{
  "error": false,
  "message": "",
  "version": {
    "edition": "developer",
    "schema": 0,
    "api": "v2"
  },
  "results": [{
    "dtGlob": "2010-01-11 03:26:05",
    "@@maxDateGlob": 0,
    "@@maxDate": 1263618953
  }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vertex_set_variable_declaration_and_assignment"><a class="anchor" href="#_vertex_set_variable_declaration_and_assignment"></a>Vertex Set Variable Declaration and Assignment</h3>
<div class="paragraph">
<p>Variables that contain a set of one or more vertices are called vertex set variables. Vertex set variables play a special role within GSQL queries. They are used for both the input and output of <code>SELECT</code> statements. Therefore, before the first <code>SELECT</code> statement in a query, a vertex set variable must be declared and initialized. This initial vertex set is called the <em>seed set</em>.</p>
</div>
<div class="paragraph">
<p>Vertex set variables are global-scoped. They are also the only type of variable that isn&#8217;t explicitly typed during declaration. To declare a vertex set variable, assign an initial set of vertices to the variable name.</p>
</div>
<div class="paragraph">
<p>{% code title="EBNF for Vertex Set Variable Declaration" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-erlang hljs" data-lang="erlang">vSetVarDeclStmt := vertexSetName ["(" vertexType ")"] "=" (seedSet | simpleSet | selectBlock)

simpleSet := vertexSetName
      | "(" simpleSet ")"
      | simpleSet (UNION | INTERSECT | MINUS) simpleSet

seedSet := "{" [seed ["," seed ]*] "}"
seed := '_'
      | ANY
      | vertexSetName
      | globalAccumName
      | vertexType ".*"
      | paramName
      | "SelectVertex" selectVertParams

selectVertParams := "(" filePath "," columnId "," (columnId | name) ","
     stringLiteral "," (TRUE | FALSE) ")" ["." FILTER "(" condition ")"]

columnId := "$" (integer | stringLiteral)</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>The query below lists all ways of assigning a vertex set variable an initial set of vertices (that is, forming a seed set).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A vertex parameter, untyped or typed, enclosed in curly brackets</p>
</li>
<li>
<p>A vertex set parameter, untyped or typed</p>
</li>
<li>
<p>A global <code>SetAccum&lt;VERTEX&gt;</code> accumulator, untyped or typed</p>
</li>
<li>
<p>All vertices of any type or of one type</p>
</li>
<li>
<p>A list of vertex IDs in an external file</p>
</li>
<li>
<p>Copy of another vertex set</p>
</li>
<li>
<p>A combination of individual vertices, vertex set parameters, or base type variables, enclosed in curly brackets</p>
</li>
<li>
<p>Union of vertex set variables</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>{% code title="Seed Set Example" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE QUERY seedSetExample(VERTEX v1, VERTEX&lt;person&gt; v2, SET&lt;VERTEX&gt; v3, SET&lt;VERTEX&lt;person&gt;&gt; v4) FOR GRAPH socialNet {
  SetAccum&lt;VERTEX&gt; @@testSet;
  SetAccum&lt;VERTEX&lt;person&gt;&gt; @@testSet2;
  S1 = { v1 };    # untyped vertex parameter enclosed in curly brackets
  S2 = { v2 };    # typed vertex parameter enclosed in curly brackets
  S3 = v3;                       # untyped vertex set parameter
  S4 = v4;                       # typed vertex set parameter
  S5 = @@testSet;                # untyped global set accumulator
  S6 = @@testSet2;               # typed global set accumulator
  S7 = ANY;                      # All vertices
  S8 = person.*;                 # All person vertices
  S9 = _;                        # Equivalent to ANY
  S10 = SelectVertex("absolute_path_to_input_file", $0, post, ",", false);   # See Section "SelectVertex()" function
  S11 = S1;                      # copy of another vertex set
  S12 = {@@testSet, v2, v3};     # Individual vertex: v2
                                 # Vertex set parameter: v3
                                 # global accumulator: @@testSet
                                 # Inside curly brackets cannot be put another
                                 # seedset, e.g., S1
  S13 = S11 UNION S12;           # but we can use UNION to combine S1
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>When declaring a vertex set variable, a set of vertex types can be optionally specified to the vertex set variable. If the vertex set variable set type is not specified explicitly, the system determines the type implicitly by the vertex set value. The type can be <code>ANY</code>, <code>_</code> (equivalent to ANY), or any explicit vertex type(s). See the EBNF grammar rule <code>vertexEdgeType</code>.</p>
</div>
<div class="paragraph">
<p>{% hint style="danger" %}
Declaration syntax difference: vertex set variable vs. base type variable</p>
</div>
<div class="paragraph">
<p>In a vertex set variable declaration, the optional type specifier follows the variable name and should be surrounded by parentheses: <strong><code>vSetName(type)</code></strong><br>
This is different than a base type variable declaration, where the type specifier is required and comes before the base variable name: <strong><code>type varName</code></strong>
{% endhint %}</p>
</div>
<div class="sect3">
<h4 id="_assignment"><a class="anchor" href="#_assignment"></a>Assignment</h4>
<div class="paragraph">
<p>After a vertex set variable is declared, the vertex type of the vertex set variable is immutable. Every assignment (e.g. <code>SELECT</code> statement) to this vertex set variable must match the type. The following is an example in which we must declare the vertex set variable type.</p>
</div>
<div class="paragraph">
<p>{% code title="Vertex set variable type" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE QUERY vertexSetVariableTypeExample(vertex&lt;person&gt; m1) FOR GRAPH socialNet {
  INT ite = 0;
  S (ANY) = {m1};   # ANY is necessary
  WHILE  ite &lt; 5 DO
    S = SELECT t
        FROM S:s - (ANY:e) -&gt; ANY:t;

    ite = ite + 1;
  END;
  PRINT S;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>In the above example, the query returns the set of vertices after a 5-step traversal from the input <code>person</code> vertex. If we declare the vertex set variable <code>S</code> without explicitly giving a type, because the type of vertex parameter <code>m1</code> is <code>person</code>, the GSQL engine will implicitly assign S to be <code>person</code> type. However, if <code>S</code> is assigned to <code>person</code> type, the <code>SELECT</code> statement inside the <code>WHILE</code> loop causes a type-checking error, because the <code>SELECT</code> block will generate all connected vertices, including non-person vertices. Therefore, <code>S</code> must be declared as an ANY-type vertex set variable.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_file_object_declaration"><a class="anchor" href="#_file_object_declaration"></a><code>FILE</code> Object Declaration</h3>
<div class="paragraph">
<p>A <code>FILE</code> object is a sequential text storage object, associated with a text file on the local machine.</p>
</div>
<div class="paragraph">
<p>{% code title="EBNF for FILE object declaration" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">fileDeclStmt := FILE fileVar "(" filePath ")"
fileVar := name</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>When a <code>FILE</code> object is declared, associated with a particular text file, any existing content in the text file will be erased. During the execution of the query, content written to or printed to the <code>FILE</code> object will be appended to the <code>FILE</code> object.  When the query where the <code>FILE</code> object is declared finishes running, the content of the <code>FILE</code> object is saved to the text file.</p>
</div>
<div class="sect3">
<h4 id="_example_2"><a class="anchor" href="#_example_2"></a>Example:</h4>
<div class="paragraph">
<p>{% code title="File object query example" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE QUERY getUSWorkerInterests (STRING fileLocation) FOR GRAPH workNet {
    // Declare FILE object f1
    FILE f1 (fileLocation);
    // Initialize a seed set of all person vertices
    P = {person.*};

    PRINT "header" TO_CSV f1;

    // Select workers located in the US and print their interests onto
    // the FILE object
    USWorkers = SELECT v FROM P:v
              WHERE v.locationId == "us"
              ACCUM f1.println(v.id, v.interestList);
    PRINT "footer" TO_CSV f1;
}
INSTALL QUERY getUSWorkers
RUN QUERY getUSWorkerInterests("/home/tigergraph/fileEx.txt")</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assignment_and_accumulate_statements"><a class="anchor" href="#_assignment_and_accumulate_statements"></a>Assignment and Accumulate Statements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Assignment statements are used to set or update the value of a variable after it has been declared. This applies to base type variables, vertex set variables, and accumulators. Accumulators also have the special += accumulate statement, which was discussed in the Accumulator section.  Assignment statements can use expressions to define the new value of the variable.</p>
</div>
<div class="paragraph">
<p>{% code title="EBNF for Assignment Statements" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">## Assignment Statement ##
assignStmt := name "=" expr         # baseType variable, vertex set variable
            | name "." name "=" expr      # attribute of a vertex or edge

attrAccumStmt := name "." attrName "+=" expr

lAccumAssignStmt := vertexAlias "." localAccumName ("+="| "=") expr

gAccumAssignStmt :=  globalAccumName ("+=" | "=") expr

loadAccumStmt := globalAccumName "=" "{" "LOADACCUM" loadAccumParam
                                  ["," "LOADACCUM" loadAccumParams]* "}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>{% hint style="success" %}
Vertex and edge (non-accumulator) attributes can use the += operator in an ACCUM or POST-ACCUM clause to perform parallel accumulation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">attrAccumStmt := name "."attrName "+=" expr</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endhint %}</p>
</div>
<div class="sect2">
<h3 id="_restrictions_on_assignment_statements"><a class="anchor" href="#_restrictions_on_assignment_statements"></a><strong>Restrictions on Assignment Statements</strong></h3>
<div class="paragraph">
<p>In general, assignment statements can take place anywhere after the variable has been declared.  However, there are some restrictions. These restrictions apply to "inner level" statements which are within the body of a higher-level statement:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>ACCUM</code> or <code>POST-ACCUM</code> clause of a <code>SELECT</code> statement</p>
</li>
<li>
<p>The <code>SET</code> clause of an <code>UPDATE</code> statement</p>
</li>
<li>
<p>The body of a <code>FOREACH</code> statement</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>{% hint style="danger" %}</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Global accumulator assignment is not permitted within the body of <code>SELECT</code> or <code>UPDATE</code> statements</p>
</li>
<li>
<p>Base type variable assignment is permitted in <code>ACCUM</code> or <code>POST-ACCUM</code> clauses, but the change in value will not take place until exiting the clause. Therefore, if there are multiple assignment statements for the same variable, only the final one will take effect.</p>
</li>
<li>
<p>Vertex attribute assignment is not permitted in an <code>ACCUM</code> clause. However, edge attribute assignment is permitted. This is because the <code>ACCUM</code> clause iterates over an edge set.</p>
</li>
<li>
<p>There are additional restrictions within <code>FOREACH</code> loops for the loop variable. See the Data Modification section.
{% endhint %}</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_loadaccum_statement"><a class="anchor" href="#_loadaccum_statement"></a><code>LOADACCUM</code> Statement</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-erlang hljs" data-lang="erlang">loadAccumStmt := globalAccumName "=" "{" LOADACCUM loadAccumParams
                                  ["," LOADACCUM loadAccumParams]* "}"

loadAccumParams := "(" filePath "," columnId ["," [columnId]* ","
          stringLiteral "," (TRUE | FALSE) ")" ["."FILTER "(" condition ")"]
columnId := "$"(integer | stringLiteral)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>LOADACCUM()</code> can initialize a global accumulator by loading data from a file. <code>LOADACCUM()</code> has 3+n parameters explained in the table below, where n is the number of fields in the accumulator.</p>
</div>
<div class="paragraph">
<p>{% hint style="danger" %}
Any accumulator using generic <code>VERTEX</code> as an element type cannot be initialized by <code>LOADACCUM()</code>.
{% endhint %}</p>
</div>
<div class="sect3">
<h4 id="_parameters"><a class="anchor" href="#_parameters"></a>Parameters:</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>filePath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The absolute file path of the input file to be read. A relative path is not supported.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>columnId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String or number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The column position(s) or column name(s) of the data file that supply data values to each field of the accumulator.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>separator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single-character string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The separator of columns.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>header</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether this file has a header.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>One assignment statement can have multiple <code>LOADACCUM()</code> function calls. However, every <code>LOADACCUM()</code> referring to the same file in the same assignment statement must use the same separator and header parameter values.</p>
</div>
</div>
<div class="sect3">
<h4 id="_example_3"><a class="anchor" href="#_example_3"></a>Example:</h4>
<div class="paragraph">
<p>{% code title="loadAccumInput.csv" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">person1,1,"test1",3
person5,2,"test2",4
person6,3,"test3",5</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>{% code title="LoadAccum example" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE QUERY loadAccumEx(STRING filename) FOR GRAPH socialNet {
  TYPEDEF TUPLE&lt;STRING aaa, VERTEX&lt;post&gt; ddd&gt; yourTuple;
  MapAccum&lt;VERTEX&lt;person&gt;, MapAccum&lt;INT, yourTuple&gt;&gt; @@testMap;
  GroupByAccum&lt;STRING a, STRING b, MapAccum&lt;STRING, STRING&gt; strList&gt; @@testGroupBy;

  @@testMap = { LOADACCUM (filename, $0, $1, $2, $3, ",", false)};
  @@testGroupBy = { LOADACCUM ( filename, $1, $2, $3, $3, ",", true) };

  PRINT @@testMap, @@testGroupBy;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="paragraph">
<p>{% code title="Results of Query loadAccumEx" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">GSQL &gt; RUN QUERY loadAccumEx("/file_directory/loadAccumInput.csv")
{
  "error": false,
  "message": "",
  "version": {
    "edition": "developer",
    "schema": 0,
    "api": "v2"
  },
  "results": [{
    "@@testGroupBy": [
      {
        "a": "3",
        "b": "\"test3\"",
        "strList": {"5": "5"}
      },
      {
        "a": "2",
        "b": "\"test2\"",
        "strList": {"4": "4"}
      }
    ],
    "@@testMap": {
      "person1": {"1": {
        "aaa": "\"test1\"",
        "ddd": "3"
      }},
      "person6": {"3": {
        "aaa": "\"test3\"",
        "ddd": "5"
      }},
      "person5": {"2": {
        "aaa": "\"test2\"",
        "ddd": "4"
      }}
    }
  }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_function_call_statements"><a class="anchor" href="#_function_call_statements"></a>Function Call Statements</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-erlang hljs" data-lang="erlang">funcCallStmt := name ["&lt;" type ["," type]* "&gt;"] "(" [argList] ")"
              | globalAccumName ("." funcName "(" [argList] ")")+
              | "reset_collection_accum" "(" accumName ")"

argList := expr ["," expr]*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Typically, a function call returns a value and so is part of an <a href="operators-and-expressions.html" class="page">expression</a>. In some cases, however, the function does not return a value (i.e., returns <code>VOID</code>) or the return value can be ignored, so the function call can be used as an entire statement. This is a Function Call Statement.</p>
</div>
<div class="paragraph">
<p>{% code title="Examples of Function Call statements" %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">ListAccum&lt;STRING&gt; @@listAcc;
BagAccum&lt;INT&gt; @@bagAcc;
...
# examples of function call statements
@@listAcc.clear();
@@bagAcc.removeAll(0);</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endcode %}</p>
</div>
<div class="sect2">
<h3 id="_clear_collection_accumulators"><a class="anchor" href="#_clear_collection_accumulators"></a>Clear Collection Accumulators</h3>
<div class="paragraph">
<p>Collection accumulators (e.g., <code>ListAccum</code>, <code>SetAccum</code>, <code>MapAccum</code>) grow in size as data is added. Particularly for vertex-attached accumulators, if the number of vertices is large, their memory consumption can be significant. It can improve system performance to clear or reset collection accumulators during a query as soon as their data is no longer needed. Running the <code>reset_collection_accum(accumName)</code> function resets the collection(s) to be zero-length (empty). If the argument is a vertex-attached accumulator, then the entire set of accumulators is reset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-erlang hljs" data-lang="erlang">"reset_collection_accum" "(" accumName ")"</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% hint style="warning" %}
<code>reset_collection_accum</code> only works in DISTRIBUTED mode queries.  If the query is not in distributed mode, the reset does not take place.
{% endhint %}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-erlang hljs" data-lang="erlang">CREATE DISTRIBUTED QUERY reset_accum()
FOR GRAPH workNet SYNTAX v2 {
  ListAccum&lt;STRING&gt; @stuff;
  ListAccum&lt;STRING&gt; @@allStuff;

  Comp = SELECT c
    FROM    person:p -(worksFor:w)- company:c
    ACCUM   c.@stuff += p.id,
            @@allStuff += p.id,
            c.@stuff += p.locationId,
            @@allStuff += p.locationId,
            FOREACH interest IN p.interestList DO
              c.@stuff += interest,
              @@allStuff += interest
            END
  ;
  // display accum size: should be full
  PRINT Comp[Comp.@stuff.size()] AS stuffCount;
  PRINT @@allStuff.size() AS allStuffCount;

  reset_collection_accum(@stuff);
  reset_collection_accum(@@allStuff);
  // display accum size: should be empty
  PRINT Comp[Comp.@stuff.size()] AS stuffClear;
  PRINT @@allStuff.size() AS allStuffClear;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-erlang hljs" data-lang="erlang">[{
    "stuffCount": [
      {"attributes": {"Comp.@stuff.size()": 23},
        "v_id": "company2",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 7},
        "v_id": "company4",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 12},
        "v_id": "company3",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 21},
        "v_id": "company1",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 4},
        "v_id": "company5",
        "v_type": "company"
      }]
  },
  {
    "allStuffCount": 67
  },
  {
    "stuffClear": [
      {"attributes": {"Comp.@stuff.size()": 0},
        "v_id": "company2",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 0},
        "v_id": "company4",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 0},
        "v_id": "company3",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 0},
        "v_id": "company1",
        "v_type": "company"
      },
      {"attributes": {"Comp.@stuff.size()": 0},
        "v_id": "company5",
        "v_type": "company"
      }]
  },
  {
    "allStuffClear": 0
  }]</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
